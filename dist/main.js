(()=>{"use strict";var e="http://178.157.218.63:25565",t={createRoom:document.getElementById("create-room"),roomSearch:document.getElementById("room-search"),roomList:document.getElementById("room-list-container"),usernameDisplay:document.getElementById("username-display"),logOut:document.getElementById("log-out"),roomTitle:document.getElementById("room-title"),chatList:document.getElementById("chat-list-container"),chatField:document.getElementById("chat-field"),popup:document.getElementById("popup"),popupForm:document.getElementById("popup-form")},n={login:{title:"login",objects:[{name:"username"},{name:"password",type:"password"}],api:e+"/api/users/login",created:function(){var e=document.createElement("a");e.textContent="sign up?",e.addEventListener("click",(function(){o("register")}),{once:!0}),t.popupForm.appendChild(e)},completed:function(e){return sessionStorage.setItem("userToken",e.token)}},register:{title:"register",objects:[{name:"username"},{name:"email",type:"mail"},{name:"password",type:"password"}],api:e+"/api/users/register",created:function(){var e=document.createElement("a");e.textContent="login?",e.addEventListener("click",(function(){o("login")}),{once:!0}),t.popupForm.appendChild(e)},completed:function(){return o("login")}},createRoom:{title:"create room",objects:[{name:"name"},{name:"password",type:"password"}],api:e+"/api/rooms/create"},joinRoom:{title:"join room",objects:[{name:"password",type:"password"}],api:e+"/api/rooms/join"}},o=function(e,r){t.popup.className="",n[e]||(t.popupForm.innerHTML="form inputs of name "+e+" not available.",console.error("form inputs of name "+e+" not available.")),t.popupForm.innerHTML=n[e].title+(r?"\n"+r:"");for(var a=n[e].objects,p={},m=0;m<a.length;m++){var i="temp-"+a[m].name+"-("+Math.random()+")",c=document.createElement("label");c.htmlFor=i,c.textContent=a[m].name;var s=document.createElement("input");s.id=i,s.placeholder="...",s.type=a[m].type||"text",t.popupForm.append(c,s),p[a[m].name]=s}n[e].created&&n[e].created();var d=document.createElement("button");return d.textContent=n[e].title,t.popupForm.appendChild(d),d.addEventListener("click",(function(){var r={token:sessionStorage.getItem("userToken")};for(var a in p)r[a]=p[a].value;!function(e,t,n){var o=JSON.stringify(t),r=new Headers;r.append("Content-Type","application/json");try{fetch(e,{method:"POST",headers:r,body:o,redirect:"follow"}).then((function(e){return e.json()})).then((function(e){return n(e)})).catch((function(e){return n(e)}))}catch(e){n(e)}}(n[e].api,r,(function(r){return r.success?(t.popup.className="hidden",n[e].completed?n[e].completed(r):void 0):o(e,r.response)}))}),{once:!0}),!0};o("login")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9mcm9td29ya2pzLWFwcC8uL3NyYy9hamF4LnRzIiwid2VicGFjazovL2Zyb213b3JranMtYXBwLy4vc3JjL2h0bWxFbGVtZW50cy50cyIsIndlYnBhY2s6Ly9mcm9td29ya2pzLWFwcC8uL3NyYy9mb3JtRGF0YS50cyIsIndlYnBhY2s6Ly9mcm9td29ya2pzLWFwcC8uL3NyYy9wb3B1cEhhbmRsZXIudHMiLCJ3ZWJwYWNrOi8vZnJvbXdvcmtqcy1hcHAvLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsiaG9zdG5hbWUiLCJodG1sRWxlbWVudHMiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZm9ybURhdGEiLCJsb2dpbiIsInRpdGxlIiwib2JqZWN0cyIsIm5hbWUiLCJ0eXBlIiwiYXBpIiwiY3JlYXRlZCIsImJ1dHRvbiIsImNyZWF0ZUVsZW1lbnQiLCJ0ZXh0Q29udGVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJkaXNwbGF5Rm9ybSIsIm9uY2UiLCJwb3B1cEZvcm0iLCJhcHBlbmRDaGlsZCIsImNvbXBsZXRlZCIsInJlc3BvbnNlIiwic2Vzc2lvblN0b3JhZ2UiLCJzZXRJdGVtIiwidG9rZW4iLCJyZWdpc3RlciIsImNyZWF0ZVJvb20iLCJqb2luUm9vbSIsIm1lc3NhZ2UiLCJwb3B1cCIsImNsYXNzTmFtZSIsImlubmVySFRNTCIsImNvbnNvbGUiLCJlcnJvciIsImZvcm1JbnB1dHMiLCJpbnB1dE9iamVjdHMiLCJpIiwibGVuZ3RoIiwidGVtcElkIiwiTWF0aCIsInJhbmRvbSIsImxhYmVsIiwiaHRtbEZvciIsImlucHV0RWxlbWVudCIsImlkIiwicGxhY2Vob2xkZXIiLCJhcHBlbmQiLCJzdWJtaXRCdXR0b24iLCJkYXRhIiwiZ2V0SXRlbSIsImZpZWxkIiwidmFsdWUiLCJ1cmwiLCJjYWxsYmFjayIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiaGVhZGVycyIsIkhlYWRlcnMiLCJmZXRjaCIsIm1ldGhvZCIsInJlZGly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LE1BQzFDTCxFQUFhaUIsVUFBVUMsWUFBWTRCLEdBRW5DQSxFQUFhaEMsaUJBQWlCLFNBQVMsV0FDbkMsSUFBSWlDLEVBQWlDLENBQ2pDeEIsTUFBT0YsZUFBZTJCLFFBQVEsY0FFbEMsSUFBSyxJQUFJQyxLQUFTZixFQUNkYSxFQUFLRSxHQUFTZixFQUFhZSxHQUFPQyxPSEMxQixTQUFDQyxFQUFhSixFQUFjSyxHQUk1QyxJQUFNQyxFQUFPQyxLQUFLQyxVQUFVUixHQUV0QlMsRUFBVSxJQUFJQyxRQUVwQkQsRUFBUVgsT0FBTyxlQUFnQixvQkFLL0IsSUFHSWEsTUFBTVAsRUFBSyxDQUFDUSxPQUFRLE9BQVFILFFBQVNBLEVBQVNILEtBQU1BLEVBQU1PLFNBQVUsV0FDL0RDLE1BQUssU0FBQVIsR0FBUSxPQUFBQSxFQUFLUyxVQUNsQkQsTUFBSyxTQUFBekMsR0FBWSxPQUFBZ0MsRUFBU2hDLE1BQzFCMkMsT0FBTSxTQUFBL0IsR0FBUyxPQUFBb0IsRUFBU3BCLE1BRS9CLE1BQU1BLEdBQ0pvQixFQUFTcEIsSUdwQlRnQyxDQUFLN0QsRUFBU0ksR0FBTUUsSUFBS3NDLEdBQU0sU0FBQzNCLEdBQzVCLE9BQUtBLEVBQVM2QyxTQUlkakUsRUFBYTRCLE1BQU1DLFVBQVksU0FDM0IxQixFQUFTSSxHQUFNWSxVQUNSaEIsRUFBU0ksR0FBTVksVUFBVUMsUUFEcEMsR0FKV0wsRUFBWVIsRUFBTWEsRUFBU0EsZUFPM0MsQ0FBQ0osTUFBTSxLQUVILEdDekRYRCxFQUFZLFUiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIEhUVFAgcmVxdWVzdCAqL1xyXG5cclxuLyoqXHJcbiAqIEV4ZWN1dGUgSFRUUCBHRVQgcmVxdWVzdCwgd2l0aCBmZXRjaCBhcGkgYXMgSlNPTi5cclxuICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIEZvciBsb2NhbCBsb2NhdGlvbiB1c2UgYC9wYXRoL2xvY2F0aW9uYCwgZm9yIG91dHNpZGUgbG9jYXRpb24gdXNlIGBodHRwKHMpOi8veW91clVSTC9sb2NhdGlvbmBcclxuICogQHBhcmFtIHsocmVzcG9uc2U6IG9iamVjdCkgPT4gdm9pZH0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBmb3IgaGFuZGxpbmcgdGhlIHJlc3BvbnNlXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gT3B0aW9uYWwsIHBhcnNlIGEgSmF2YVNjcmlwdCBvYmplY3QgYXMgcmVxdXN0IGJvZHlcclxuICovXHJcblxyXG4gZXhwb3J0IGNvbnN0IGhvc3RuYW1lID0gJ2h0dHA6Ly8xNzguMTU3LjIxOC42MzoyNTU2NSdcclxuXHJcbiBleHBvcnQgY29uc3QgZ2V0ID0gKHVybDogc3RyaW5nLCBjYWxsYmFjazogKHJlc3BvbnNlOiBvYmplY3QsIGVycm9yPzogYm9vbGVhbikgPT4gdm9pZCwgZGF0YT86IG9iamVjdCk6IHZvaWQgPT4ge1xyXG4gICAgXHJcbiAgICAvLyBzZXR0aW5nIHVwIHJlcXVlc3QgYW5kIGJvZHlcclxuXHJcbiAgICBjb25zdCBib2R5ID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcblxyXG4gICAgY29uc3QgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XHJcblxyXG4gICAgaGVhZGVycy5hcHBlbmQoXCJDb250ZW50LVR5cGVcIiwgXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xyXG5cclxuXHJcblxyXG4gICAgLy8gbWF4aW11bSBlcnJvciBoYW5kbGluZyB0byBtYWludGFpbiBzdGFiaWxpdHlcclxuICAgIHRyeSB7XHJcblxyXG4gICAgICAgIC8vIGV4ZWN1dGUgcmVxdWVzdCwgZm9sbG93cyByZWRpcmVjdHMsIGV4cGVjdHMganNvblxyXG4gICAgICAgIGZldGNoKHVybCwge21ldGhvZDogJ0dFVCcsIGhlYWRlcnM6IGhlYWRlcnMsIGJvZHk6IGJvZHksIHJlZGlyZWN0OiAnZm9sbG93J30pXHJcbiAgICAgICAgICAgIC50aGVuKGJvZHkgPT4gYm9keS5qc29uKCkpXHJcbiAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IGNhbGxiYWNrKHJlc3BvbnNlKSlcclxuICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IGNhbGxiYWNrKGVycm9yLCB0cnVlKSk7XHJcblxyXG4gICAgfSBjYXRjaChlcnJvcikge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCB0cnVlKTtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcblxyXG4vKipcclxuICogRXhlY3V0ZSBIVFRQIEdFVCByZXF1ZXN0LCB3aXRoIGZldGNoIGFwaSBhcyBKU09OLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsIC0gVXJsIHJlbGF0aXZlIHRvIHJvb3QsIGZvciBvdXRzaWRlIHVzZSBgaHR0cChzKTovL2BcclxuICogQHBhcmFtIHtvYmplY3R9IGRhdGEgLSBQYXJzZSBhIEphdmFTY3JpcHQgb2JqZWN0IGFzIHJlcXVzdCBib2R5XHJcbiAqIEBwYXJhbSB7KHJlc3BvbnNlOiBvYmplY3QpID0+IHZvaWR9IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24gZm9yIGhhbmRsaW5nIHRoZSByZXNwb25zZVxyXG4gKi9cclxuXHJcbmV4cG9ydCBjb25zdCBwb3N0ID0gKHVybDogc3RyaW5nLCBkYXRhOiBvYmplY3QsIGNhbGxiYWNrOiAocmVzcG9uc2U6IG9iamVjdCwgZXJyb3I/OiBib29sZWFuKSA9PiB2b2lkKSA9PiB7XHJcbiAgICBcclxuICAgIC8vIHNldHRpbmcgdXAgcmVxdWVzdCBhbmQgYm9keVxyXG5cclxuICAgIGNvbnN0IGJvZHkgPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcclxuXHJcbiAgICBjb25zdCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcclxuXHJcbiAgICBoZWFkZXJzLmFwcGVuZChcIkNvbnRlbnQtVHlwZVwiLCBcImFwcGxpY2F0aW9uL2pzb25cIik7XHJcblxyXG5cclxuXHJcbiAgICAvLyBtYXhpbXVtIGVycm9yIGhhbmRsaW5nIHRvIG1haW50YWluIHN0YWJpbGl0eVxyXG4gICAgdHJ5IHtcclxuXHJcbiAgICAgICAgLy8gZXhlY3V0ZSByZXF1ZXN0LCBmb2xsb3dzIHJlZGlyZWN0cywgZXhwZWN0cyBqc29uXHJcbiAgICAgICAgZmV0Y2godXJsLCB7bWV0aG9kOiAnUE9TVCcsIGhlYWRlcnM6IGhlYWRlcnMsIGJvZHk6IGJvZHksIHJlZGlyZWN0OiAnZm9sbG93J30pXHJcbiAgICAgICAgICAgIC50aGVuKGJvZHkgPT4gYm9keS5qc29uKCkpXHJcbiAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IGNhbGxiYWNrKHJlc3BvbnNlKSlcclxuICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IGNhbGxiYWNrKGVycm9yLCB0cnVlKSk7XHJcblxyXG4gICAgfSBjYXRjaChlcnJvcikge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCB0cnVlKTtcclxuICAgIH1cclxuXHJcbn0iLCJleHBvcnQgY29uc3QgaHRtbEVsZW1lbnRzID0ge1xyXG4gICAgJ2NyZWF0ZVJvb20nOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3JlYXRlLXJvb20nKSEsXHJcbiAgICAncm9vbVNlYXJjaCc6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb29tLXNlYXJjaCcpISxcclxuICAgICdyb29tTGlzdCc6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb29tLWxpc3QtY29udGFpbmVyJykhLFxyXG4gICAgJ3VzZXJuYW1lRGlzcGxheSc6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VybmFtZS1kaXNwbGF5JykhLFxyXG4gICAgJ2xvZ091dCc6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2ctb3V0JykhLFxyXG4gICAgJ3Jvb21UaXRsZSc6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb29tLXRpdGxlJykhLFxyXG4gICAgJ2NoYXRMaXN0JzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoYXQtbGlzdC1jb250YWluZXInKSEsXHJcbiAgICAnY2hhdEZpZWxkJzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoYXQtZmllbGQnKSEsXHJcbiAgICAncG9wdXAnOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXAnKSEsXHJcbiAgICAncG9wdXBGb3JtJzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwLWZvcm0nKSEsXHJcbn0iLCJpbXBvcnQgeyBodG1sRWxlbWVudHMgfSBmcm9tIFwiLi9odG1sRWxlbWVudHNcIjtcclxuaW1wb3J0IHsgZGlzcGxheUZvcm0gfSBmcm9tIFwiLi9wb3B1cEhhbmRsZXJcIjtcclxuaW1wb3J0IHsgaG9zdG5hbWUgfSBmcm9tICcuL2FqYXgnO1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1EYXRhOiBhbnkgPSB7XHJcbiAgICBsb2dpbjoge1xyXG4gICAgICAgIHRpdGxlOiAnbG9naW4nLFxyXG4gICAgICAgIG9iamVjdHM6IFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ3VzZXJuYW1lJyxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ3Bhc3N3b3JkJyxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdwYXNzd29yZCcsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIGFwaTogaG9zdG5hbWUgKyAnL2FwaS91c2Vycy9sb2dpbicsXHJcbiAgICAgICAgY3JlYXRlZDogKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgYnV0dG9uID0gPEhUTUxFbGVtZW50PmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgICAgICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gJ3NpZ24gdXA/J1xyXG4gICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5Rm9ybSgncmVnaXN0ZXInKTtcclxuICAgICAgICAgICAgfSwge29uY2U6IHRydWV9KVxyXG4gICAgICAgICAgICBodG1sRWxlbWVudHMucG9wdXBGb3JtLmFwcGVuZENoaWxkKGJ1dHRvbik7ICAgIFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY29tcGxldGVkOiAocmVzcG9uc2U6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgndXNlclRva2VuJywgcmVzcG9uc2UudG9rZW4pXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHJlZ2lzdGVyOiB7XHJcbiAgICAgICAgdGl0bGU6ICdyZWdpc3RlcicsXHJcbiAgICAgICAgb2JqZWN0czogW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAndXNlcm5hbWUnLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnZW1haWwnLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogJ21haWwnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdwYXNzd29yZCcsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAncGFzc3dvcmQnLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXSxcclxuICAgICAgICBhcGk6IGhvc3RuYW1lICsgJy9hcGkvdXNlcnMvcmVnaXN0ZXInLFxyXG4gICAgICAgIGNyZWF0ZWQ6ICgpID0+IHtcclxuICAgICAgICAgICAgbGV0IGJ1dHRvbiA9IDxIVE1MRWxlbWVudD5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9ICdsb2dpbj8nXHJcbiAgICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGRpc3BsYXlGb3JtKCdsb2dpbicpO1xyXG4gICAgICAgICAgICB9LCB7b25jZTogdHJ1ZX0pXHJcbiAgICAgICAgICAgIGh0bWxFbGVtZW50cy5wb3B1cEZvcm0uYXBwZW5kQ2hpbGQoYnV0dG9uKTsgICAgICBcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNvbXBsZXRlZDogKCkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gZGlzcGxheUZvcm0oJ2xvZ2luJylcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuICAgIGNyZWF0ZVJvb206IHtcclxuICAgICAgICB0aXRsZTogJ2NyZWF0ZSByb29tJyxcclxuICAgICAgICBvYmplY3RzOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICduYW1lJyxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ3Bhc3N3b3JkJyxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdwYXNzd29yZCcsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIGFwaTogaG9zdG5hbWUgKyAnL2FwaS9yb29tcy9jcmVhdGUnLFxyXG4gICAgfSxcclxuICAgIGpvaW5Sb29tOiB7XHJcbiAgICAgICAgdGl0bGU6ICdqb2luIHJvb20nLFxyXG4gICAgICAgIG9iamVjdHM6IFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ3Bhc3N3b3JkJyxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdwYXNzd29yZCcsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIGFwaTogaG9zdG5hbWUgKyAnL2FwaS9yb29tcy9qb2luJyxcclxuICAgIH1cclxufSIsImltcG9ydCB7IHBvc3QgfSBmcm9tICcuL2FqYXgnXHJcbmltcG9ydCB7IGh0bWxFbGVtZW50cyB9IGZyb20gJy4vaHRtbEVsZW1lbnRzJ1xyXG5pbXBvcnQgeyBmb3JtRGF0YSB9IGZyb20gJy4vZm9ybURhdGEnXHJcblxyXG5leHBvcnQgY29uc3QgZGlzcGxheUZvcm0gPSAobmFtZTogc3RyaW5nLCBtZXNzYWdlPzogc3RyaW5nKSA9PiB7XHJcbiAgICBodG1sRWxlbWVudHMucG9wdXAuY2xhc3NOYW1lID0gJyc7XHJcbiAgICBpZiAoIWZvcm1EYXRhW25hbWVdKSB7XHJcbiAgICAgICAgaHRtbEVsZW1lbnRzLnBvcHVwRm9ybS5pbm5lckhUTUwgPSBgZm9ybSBpbnB1dHMgb2YgbmFtZSAke25hbWV9IG5vdCBhdmFpbGFibGUuYDtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGBmb3JtIGlucHV0cyBvZiBuYW1lICR7bmFtZX0gbm90IGF2YWlsYWJsZS5gKTtcclxuICAgIH1cclxuICAgIGh0bWxFbGVtZW50cy5wb3B1cEZvcm0uaW5uZXJIVE1MID0gZm9ybURhdGFbbmFtZV0udGl0bGUgKyAobWVzc2FnZSA/ICdcXG4nICsgbWVzc2FnZSA6ICcnKTtcclxuXHJcbiAgICBsZXQgZm9ybUlucHV0cyA9IGZvcm1EYXRhW25hbWVdLm9iamVjdHM7XHJcbiAgICBsZXQgaW5wdXRPYmplY3RzOiB7IFtrZXk6IHN0cmluZ10gOiBIVE1MSW5wdXRFbGVtZW50fSA9IHt9XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmb3JtSW5wdXRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgbGV0IHRlbXBJZCA9IGB0ZW1wLSR7Zm9ybUlucHV0c1tpXS5uYW1lfS0oJHtNYXRoLnJhbmRvbSgpfSlgXHJcblxyXG4gICAgICAgIGxldCBsYWJlbCA9IDxIVE1MTGFiZWxFbGVtZW50PmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XHJcbiAgICAgICAgbGFiZWwuaHRtbEZvciA9IHRlbXBJZDtcclxuICAgICAgICBsYWJlbC50ZXh0Q29udGVudCA9IGZvcm1JbnB1dHNbaV0ubmFtZTtcclxuXHJcbiAgICAgICAgbGV0IGlucHV0RWxlbWVudCA9IDxIVE1MSW5wdXRFbGVtZW50PmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmlkID0gdGVtcElkO1xyXG4gICAgICAgIGlucHV0RWxlbWVudC5wbGFjZWhvbGRlciA9ICcuLi4nO1xyXG4gICAgICAgIGlucHV0RWxlbWVudC50eXBlID0gZm9ybUlucHV0c1tpXS50eXBlIHx8ICd0ZXh0JyxcclxuXHJcbiAgICAgICAgaHRtbEVsZW1lbnRzLnBvcHVwRm9ybS5hcHBlbmQobGFiZWwsIGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgaW5wdXRPYmplY3RzW2Zvcm1JbnB1dHNbaV0ubmFtZV0gPSBpbnB1dEVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGZvcm1EYXRhW25hbWVdLmNyZWF0ZWQpXHJcbiAgICAgICAgZm9ybURhdGFbbmFtZV0uY3JlYXRlZCgpO1xyXG5cclxuICAgIC8vIHN1Ym1pdCBidXR0b25cclxuICAgIFxyXG4gICAgbGV0IHN1Ym1pdEJ1dHRvbiA9IDxIVE1MQnV0dG9uRWxlbWVudD5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGZvcm1EYXRhW25hbWVdLnRpdGxlO1xyXG4gICAgaHRtbEVsZW1lbnRzLnBvcHVwRm9ybS5hcHBlbmRDaGlsZChzdWJtaXRCdXR0b24pXHJcblxyXG4gICAgc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIGxldCBkYXRhOiB7IFtmaWVsZDogc3RyaW5nXTogYW55IH0gPSB7XHJcbiAgICAgICAgICAgIHRva2VuOiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCd1c2VyVG9rZW4nKSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGZvciAobGV0IGZpZWxkIGluIGlucHV0T2JqZWN0cykge1xyXG4gICAgICAgICAgICBkYXRhW2ZpZWxkXSA9IGlucHV0T2JqZWN0c1tmaWVsZF0udmFsdWVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHBvc3QoZm9ybURhdGFbbmFtZV0uYXBpLCBkYXRhLCAocmVzcG9uc2U6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLnN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkaXNwbGF5Rm9ybShuYW1lLCByZXNwb25zZS5yZXNwb25zZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaHRtbEVsZW1lbnRzLnBvcHVwLmNsYXNzTmFtZSA9IFwiaGlkZGVuXCI7XHJcbiAgICAgICAgICAgIGlmIChmb3JtRGF0YVtuYW1lXS5jb21wbGV0ZWQpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZm9ybURhdGFbbmFtZV0uY29tcGxldGVkKHJlc3BvbnNlKTtcclxuICAgICAgICB9KVxyXG4gICAgfSwge29uY2U6IHRydWV9KVxyXG5cclxuICAgIHJldHVybiB0cnVlO1xyXG59IiwiaW1wb3J0IHsgZGlzcGxheUZvcm0gfSBmcm9tIFwiLi9wb3B1cEhhbmRsZXJcIjtcclxuXHJcbmRpc3BsYXlGb3JtKCdsb2dpbicpIl0sInNvdXJjZVJvb3QiOiIifQ==